import { LatLngTuple } from 'leaflet';

export interface Quadrant {
  name: string;
  data: RowData[];
}

export const UP = 1;
export const DOWN = -1;

export interface RowData {
  // If the row loops back around for a second row
  double: boolean;

  // Queue of parking spot numbers to insert a space before
  //   range: [1, 5]
  //   skipAt: [3]
  //   => [1, 2, _, 3, 4, 5]
  spaces: number[];

  // Parking numbers
  range: [number, number];

  // Geographical coordinates of a row
  points: {
    start: [LatLngTuple, LatLngTuple];
    end: [LatLngTuple, LatLngTuple];
  };
}

type NumberOrRange = number | [number, number];
export interface HighlightSpots {
  disabled: NumberOrRange[];
  reserved: NumberOrRange[];
  staff: NumberOrRange[];
  visitor: NumberOrRange[];
  special: NumberOrRange[];
}

export const MAP_DATA: Quadrant[] = [
  {
    name: 'Athletic Lot',
    data: [
      {
        double: true,
        spaces: [17, 30],
        range: [1, 70],
        points: {
          start: [
            [29.746550358390046, -95.77696792781354],
            [29.746399570366293, -95.77688612043859],
          ],
          end: [
            [29.746121279336986, -95.7780196890235],
            [29.745966997491447, -95.77793788164857],
          ],
        },
      },
      {
        double: true,
        spaces: [],
        range: [71, 142],
        points: {
          start: [
            [29.746386760684654, -95.77687941491604],
            [29.746244123137938, -95.7768002897501],
          ],
          end: [
            [29.745955353568924, -95.77793117612602],
            [29.745807475635456, -95.77785070985556],
          ],
        },
      },
      {
        double: true,
        spaces: [],
        range: [143, 214],
        points: {
          start: [
            [29.74623189705307, -95.77679358422758],
            [29.746088094895267, -95.77671445906164],
          ],
          end: [
            [29.745794667300235, -95.77784333378078],
            [29.745656104296575, -95.77776890248062],
          ],
        },
      },
      {
        double: true,
        spaces: [],
        range: [215, 286],
        points: {
          start: [
            [29.746077615377732, -95.7767077535391],
            [29.745938470568817, -95.77663131058219],
          ],
          end: [
            [29.745642131546063, -95.77776152640583],
            [29.745501356599267, -95.7776864245534],
          ],
        },
      },
      {
        double: false,
        spaces: [],
        range: [287, 322],
        points: {
          start: [
            [29.74589666880199, -95.77669635415079],
            [29.74581865444066, -95.77665276825431],
          ],
          end: [
            [29.745515911568074, -95.77761031687261],
            [29.745435568113805, -95.77756740152837],
          ],
        },
      },
      {
        double: false,
        spaces: [341],
        range: [323, 355],
        points: {
          start: [
            [29.74530631981314, -95.7774728536606],
            [29.745223065188902, -95.7774292677641],
          ],
          end: [
            [29.745657967952898, -95.77660448849201],
            [29.745584028794124, -95.77656358480455],
          ],
        },
      },
    ],
  },
  {
    name: '1600 Lot',
    data: [
      {
        double: true,
        spaces: [357, 386, 386],
        range: [356, 418],
        points: {
          start: [
            [29.746116738837426, -95.77803544700147],
            [29.74596245698489, -95.77795162796976],
          ],
          end: [
            [29.74574529759776, -95.77894806861877],
            [29.745587521983946, -95.77886492013933],
          ],
        },
      },
      {
        double: true,
        spaces: [459, 459, 459],
        range: [419, 501],
        points: {
          start: [
            [29.745950230865674, -95.77794559299946],
            [29.7458029351217, -95.77786512672901],
          ],
          end: [
            [29.74547515765005, -95.77909089624882],
            [29.74532669680854, -95.77901110053065],
          ],
        },
      },

      {
        double: true,
        spaces: [],
        range: [502, 585],
        points: {
          start: [
            [29.74579070898302, -95.77785976231101],
            [29.74564865278628, -95.77778197824956],
          ],
          end: [
            [29.74532669680854, -95.77897958457471],
            [29.745188715358744, -95.77890180051328],
          ],
        },
      },
      {
        double: true,
        spaces: [627],
        range: [586, 666],
        points: {
          start: [
            [29.745637008826808, -95.77777661383153],
            [29.74549495241232, -95.77769882977009],
          ],
          end: [
            [29.745182893352457, -95.77888101339342],
            [29.745042582898954, -95.77879015356305],
          ],
        },
      },
      {
        double: false,
        spaces: [],
        range: [667, 694],
        points: {
          start: [
            [29.745456527282002, -95.77775649726392],
            [29.74538200577519, -95.77771894633771],
          ],
          end: [
            [29.74516018752477, -95.77847331762315],
            [29.745082172590383, -95.77843107283117],
          ],
        },
      },
      {
        double: false,
        spaces: [],
        range: [695, 700],
        points: {
          start: [
            [29.74509439881545, -95.77862955629827],
            [29.7450227880474, -95.7785886526108],
          ],
          end: [
            [29.745030356667577, -95.77878311276437],
            [29.74495641704597, -95.77874489128592],
          ],
        },
      },
      {
        double: false,
        spaces: [],
        range: [701, 722],
        points: {
          start: [
            [29.744970389892025, -95.77828355133533],
            [29.744890628202963, -95.77824264764787],
          ],
          end: [
            [29.745202688172434, -95.777724981308],
            [29.745124091070135, -95.77768340706827],
          ],
        },
      },
      {
        double: false,
        range: [723, 729],
        spaces: [728, 729],
        points: {
          start: [
            [29.74574005782122, -95.7793939858675],
            [29.74570512597057, -95.77929809689523],
          ],
          end: [
            [29.745574713620634, -95.77948652207853],
            [29.745532213130673, -95.77939666807653],
          ],
        },
      },
      {
        double: false,
        range: [730, 735],
        spaces: [],
        points: {
          start: [
            [29.745526391144335, -95.77938392758371],
            [29.74549495241232, -95.77931955456735],
          ],
          end: [
            [29.74566728311865, -95.77930212020874],
            [29.74563991981681, -95.77923481855505],
          ],
        },
      },
    ],
  },
  {
    name: '1200 Lot',
    data: [
      {
        double: false,
        range: [736, 742],
        spaces: [737, 738],
        points: {
          start: [
            [29.74542159533258, -95.77971920371058],
            [29.745349984798214, -95.77970981597902],
          ],
          end: [
            [29.745387245570434, -95.77996328473093],
            [29.745306902013063, -95.77996127307416],
          ],
        },
      },
      {
        double: false,
        range: [743, 748],
        spaces: [],
        points: {
          start: [
            [29.745299915613725, -95.77989421784879],
            [29.745219571986357, -95.77987879514696],
          ],
          end: [
            [29.745336012005055, -95.77970914542678],
            [29.745260326008296, -95.77969573438169],
          ],
        },
      },
      {
        double: true,
        range: [749, 833],
        spaces: [749, 749, 750],
        points: {
          start: [
            [29.74505248032328, -95.78009312543983],
            [29.744927889145917, -95.77993109822275],
          ],
          end: [
            [29.744217017831122, -95.78102476894858],
            [29.744096599796197, -95.78088102433796],
          ],
        },
      },
      {
        double: true,
        range: [834, 938],
        spaces: [834, 834, 834],
        points: {
          start: [
            [29.745093234413133, -95.77972926199438],
            [29.744975629708794, -95.77960319817066],
          ],
          end: [
            [29.74408893237369, -95.78086987137796],
            [29.74397656636041, -95.78073643147947],
          ],
        },
      },
      {
        double: true,
        range: [939, 1044],
        spaces: [],
        points: {
          start: [
            [29.74494649926342, -95.77961325645447],
            [29.74483003844359, -95.77948987483978],
          ],
          end: [
            [29.743965484065498, -95.78072570264341],
            [29.743857193372346, -95.78059628605844],
          ],
        },
      },
      {
        double: true,
        range: [1045, 1147],
        spaces: [1148],
        points: {
          start: [
            [29.744804462219395, -95.7794999331236],
            [29.744692097007945, -95.77937051653862],
          ],
          end: [
            [29.74384906280421, -95.78058488667011],
            [29.743734949894986, -95.78044876456264],
          ],
        },
      },
      {
        double: false,
        range: [1148, 1152],
        spaces: [],
        points: {
          start: [
            [29.744667062254564, -95.77937990427019],
            [29.74460243762973, -95.77931351959705],
          ],
          end: [
            [29.744578567262277, -95.77947512269022],
            [29.744525004465842, -95.77941209077837],
          ],
        },
      },
    ],
  },
  {
    name: 'PAC',
    data: [
      {
        double: true,
        range: [1192, 1219],
        spaces: [1205, 1205],
        points: {
          start: [
            [29.74420712032433, -95.78103415668012],
            [29.74408835016669, -95.7808926701546],
          ],
          end: [
            [29.743864782429497, -95.78141100704673],
            [29.743752416165005, -95.78127890825273],
          ],
        },
      },
      {
        double: true,
        range: [1220, 1247],
        spaces: [1233, 1233],
        points: {
          start: [
            [29.744078452647205, -95.78088194131854],
            [29.74396725103759, -95.78074850142004],
          ],
          end: [
            [29.743733785476866, -95.78127622604372],
            [29.74362665895286, -95.78114815056327],
          ],
        },
      },
      {
        double: true,
        range: [1248, 1278],
        spaces: [1264],
        points: {
          start: [
            [29.74395677129838, -95.78073576092721],
            [29.743848480595812, -95.7806070148945],
          ],
          end: [
            [29.743583575427227, -95.78117698431016],
            [29.743475866532183, -95.7810475677252],
          ],
        },
      },
      {
        double: true,
        range: [1279, 1296],
        spaces: [1289, 1289],
        points: {
          start: [
            [29.743840911886426, -95.78059628605844],
            [29.7437244701315, -95.7804594933987],
          ],
          end: [
            [29.743564944707718, -95.7809215039015],
            [29.743446756000157, -95.78077331185342],
          ],
        },
      },
      {
        double: false,
        range: [1297, 1304],
        spaces: [],
        points: {
          start: [
            [29.74367032466941, -95.78050039708614],
            [29.743617925807264, -95.78043937683107],
          ],
          end: [
            [29.743527683258293, -95.78065998852256],
            [29.74347877758493, -95.78060366213323],
          ],
        },
      },
    ],
  },
];

export const highlightSpots: HighlightSpots = {
  disabled: [
    /* todo */
  ],
  reserved: [],
  staff: [
    [1, 9],
    [62, 79],
    [134, 142],
    [358, 364],
    384,
    386,
    [388, 458],
    [487, 501],
    [723, 726],
    [730, 735],
    [752, 758],
    [760, 767],
    [812, 864],
    [908, 953],
    [1030, 1050],
    [1312, 1305],
    [1328, 1341],
    [1355, 1368],
    [1379, 1389],
    [1399, 1402],
    [1404, 1408],
  ],
  visitor: [[365, 382], [744, 747], 751, 759, [1192, 1204]],
  special: [385, 387, [739, 743], 748],
};

export function isHighlightedSpot(
  spots: HighlightSpots | undefined,
  spot: number
) {
  if (!spots) {
    return false;
  }

  return (
    spots.disabled.includes(spot) ||
    spots.reserved.includes(spot) ||
    spots.staff.includes(spot) ||
    spots.visitor.includes(spot) ||
    spots.special.includes(spot)
  );
}
